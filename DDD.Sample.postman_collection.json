{
	"info": {
		"_postman_id": "ddd-sample-collection",
		"name": "DDD Sample - Order & Payment APIs",
		"description": "Postman collection for testing the DDD Sample microservices.\n\n**Order Service**: http://localhost:5001\n**Payment Service**: http://localhost:5002\n\nThis collection demonstrates CQRS pattern with Commands (write operations) and Queries (read operations).",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "orderServiceUrl",
			"value": "http://localhost:5001",
			"type": "string"
		},
		{
			"key": "paymentServiceUrl",
			"value": "http://localhost:5002",
			"type": "string"
		},
		{
			"key": "customerId",
			"value": "{{$guid}}",
			"type": "string"
		},
		{
			"key": "orderId",
			"value": "",
			"type": "string"
		},
		{
			"key": "orderItemId",
			"value": "",
			"type": "string"
		},
		{
			"key": "paymentId",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Order Service",
			"item": [
				{
					"name": "Queries",
					"item": [
						{
							"name": "Get Order by ID",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}"]
								},
								"description": "Retrieves a specific order by its unique identifier."
							},
							"response": []
						},
						{
							"name": "Get Orders by Customer",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/customer/{{customerId}}",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "customer", "{{customerId}}"]
								},
								"description": "Retrieves all orders for a specific customer."
							},
							"response": []
						},
						{
							"name": "Get Orders by Status",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/status/Draft",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "status", "Draft"]
								},
								"description": "Retrieves all orders with a specific status. Valid statuses: Draft, Submitted, Confirmed, Shipped, Delivered, Cancelled"
							},
							"response": []
						},
						{
							"name": "Get Pending Orders",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/pending",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "pending"]
								},
								"description": "Retrieves all pending orders that haven't been processed yet."
							},
							"response": []
						}
					],
					"description": "Query operations for reading order data (CQRS - Read side)"
				},
				{
					"name": "Commands",
					"item": [
						{
							"name": "Create Order",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    var orderId = pm.response.json();",
											"    pm.collectionVariables.set('orderId', orderId);",
											"    console.log('Order created with ID: ' + orderId);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"customerId\": \"{{customerId}}\",\n    \"shippingAddress\": {\n        \"street\": \"123 Main Street\",\n        \"city\": \"New York\",\n        \"state\": \"NY\",\n        \"country\": \"USA\",\n        \"zipCode\": \"10001\"\n    },\n    \"currency\": \"USD\",\n    \"notes\": \"Please deliver before 5 PM\"\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders"]
								},
								"description": "Creates a new order in Draft status. Returns the new order ID."
							},
							"response": []
						},
						{
							"name": "Add Order Item",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"productId\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"productName\": \"Wireless Keyboard\",\n    \"unitPrice\": 79.99,\n    \"quantity\": 2\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/items",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "items"]
								},
								"description": "Adds a new item to an existing order. Only works on Draft orders."
							},
							"response": []
						},
						{
							"name": "Remove Order Item",
							"request": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/items/{{orderItemId}}",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "items", "{{orderItemId}}"]
								},
								"description": "Removes an item from an order. Only works on Draft orders."
							},
							"response": []
						},
						{
							"name": "Update Shipping Address",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"street\": \"456 Oak Avenue\",\n    \"city\": \"Los Angeles\",\n    \"state\": \"CA\",\n    \"country\": \"USA\",\n    \"zipCode\": \"90001\"\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/address",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "address"]
								},
								"description": "Updates the shipping address for an order."
							},
							"response": []
						},
						{
							"name": "Submit Order",
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/submit",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "submit"]
								},
								"description": "Submits a Draft order for processing. Order must have at least one item and meet the minimum order value. Triggers OrderSubmittedDomainEvent."
							},
							"response": []
						},
						{
							"name": "Cancel Order",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"reason\": \"Customer changed their mind\"\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/cancel",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "cancel"]
								},
								"description": "Cancels an order. Uses CancellableOrderSpecification to validate if order can be cancelled. Triggers OrderCancelledDomainEvent."
							},
							"response": []
						}
					],
					"description": "Command operations for modifying order state (CQRS - Write side)"
				}
			],
			"description": "Order bounded context - Manages order lifecycle from draft to delivery"
		},
		{
			"name": "Payment Service",
			"item": [
				{
					"name": "Queries",
					"item": [
						{
							"name": "Get Payment by ID",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}"]
								},
								"description": "Retrieves a specific payment by its unique identifier."
							},
							"response": []
						},
						{
							"name": "Get Payment by Order ID",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/order/{{orderId}}",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "order", "{{orderId}}"]
								},
								"description": "Retrieves the payment associated with a specific order."
							},
							"response": []
						},
						{
							"name": "Get Payments by Customer",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/customer/{{customerId}}",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "customer", "{{customerId}}"]
								},
								"description": "Retrieves all payments for a specific customer."
							},
							"response": []
						},
						{
							"name": "Get Pending Payments",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/pending",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "pending"]
								},
								"description": "Retrieves all pending payments awaiting processing."
							},
							"response": []
						}
					],
					"description": "Query operations for reading payment data (CQRS - Read side)"
				},
				{
					"name": "Commands",
					"item": [
						{
							"name": "Create Payment",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    var paymentId = pm.response.json();",
											"    pm.collectionVariables.set('paymentId', paymentId);",
											"    console.log('Payment created with ID: ' + paymentId);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"orderId\": \"{{orderId}}\",\n    \"customerId\": \"{{customerId}}\",\n    \"amount\": 159.98,\n    \"currency\": \"USD\",\n    \"method\": \"CreditCard\",\n    \"cardDetails\": {\n        \"last4Digits\": \"4242\",\n        \"cardType\": \"Visa\",\n        \"expiryMonth\": 12,\n        \"expiryYear\": 2025,\n        \"cardHolderName\": \"John Doe\"\n    }\n}"
								},
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments"]
								},
								"description": "Creates a new payment in Pending status. Supports CreditCard, DebitCard, BankTransfer, PayPal methods."
							},
							"response": []
						},
						{
							"name": "Process Payment",
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}/process",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}", "process"]
								},
								"description": "Starts processing a pending payment. Changes status to Processing."
							},
							"response": []
						},
						{
							"name": "Complete Payment",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"transactionId\": \"TXN-2024-001234\"\n}"
								},
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}/complete",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}", "complete"]
								},
								"description": "Marks a processing payment as completed. Requires a transaction ID from the payment gateway. Triggers PaymentCompletedDomainEvent and publishes PaymentCompletedIntegrationEvent."
							},
							"response": []
						},
						{
							"name": "Fail Payment",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"reason\": \"Insufficient funds\"\n}"
								},
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}/fail",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}", "fail"]
								},
								"description": "Marks a payment as failed with a reason. Triggers PaymentFailedDomainEvent."
							},
							"response": []
						},
						{
							"name": "Refund Payment",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"reason\": \"Customer requested refund\"\n}"
								},
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}/refund",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}", "refund"]
								},
								"description": "Initiates a refund for a completed payment. Only completed payments can be refunded. Triggers PaymentRefundedDomainEvent."
							},
							"response": []
						}
					],
					"description": "Command operations for modifying payment state (CQRS - Write side)"
				}
			],
			"description": "Payment bounded context - Manages payment processing and lifecycle"
		},
		{
			"name": "Workflows",
			"item": [
				{
					"name": "Complete Order Flow",
					"item": [
						{
							"name": "1. Create Order",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"pm.collectionVariables.set('customerId', pm.variables.replaceIn('{{$guid}}'));"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Order created successfully', function() {",
											"    pm.response.to.have.status(201);",
											"});",
											"",
											"if (pm.response.code === 201) {",
											"    var orderId = pm.response.json();",
											"    pm.collectionVariables.set('orderId', orderId);",
											"    console.log('Created order: ' + orderId);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"customerId\": \"{{customerId}}\",\n    \"shippingAddress\": {\n        \"street\": \"123 Main Street\",\n        \"city\": \"New York\",\n        \"state\": \"NY\",\n        \"country\": \"USA\",\n        \"zipCode\": \"10001\"\n    },\n    \"currency\": \"USD\",\n    \"notes\": \"Test order\"\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders"]
								}
							},
							"response": []
						},
						{
							"name": "2. Add First Item",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Item added successfully', function() {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"productId\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"productName\": \"Wireless Keyboard\",\n    \"unitPrice\": 79.99,\n    \"quantity\": 1\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/items",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "items"]
								}
							},
							"response": []
						},
						{
							"name": "3. Add Second Item",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Item added successfully', function() {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"productId\": \"550e8400-e29b-41d4-a716-446655440002\",\n    \"productName\": \"USB Mouse\",\n    \"unitPrice\": 29.99,\n    \"quantity\": 2\n}"
								},
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/items",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "items"]
								}
							},
							"response": []
						},
						{
							"name": "4. Submit Order",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Order submitted successfully', function() {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}/submit",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}", "submit"]
								}
							},
							"response": []
						},
						{
							"name": "5. Create Payment",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Payment created successfully', function() {",
											"    pm.response.to.have.status(201);",
											"});",
											"",
											"if (pm.response.code === 201) {",
											"    var paymentId = pm.response.json();",
											"    pm.collectionVariables.set('paymentId', paymentId);",
											"    console.log('Created payment: ' + paymentId);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"orderId\": \"{{orderId}}\",\n    \"customerId\": \"{{customerId}}\",\n    \"amount\": 139.97,\n    \"currency\": \"USD\",\n    \"method\": \"CreditCard\",\n    \"cardDetails\": {\n        \"last4Digits\": \"4242\",\n        \"cardType\": \"Visa\",\n        \"expiryMonth\": 12,\n        \"expiryYear\": 2025,\n        \"cardHolderName\": \"John Doe\"\n    }\n}"
								},
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments"]
								}
							},
							"response": []
						},
						{
							"name": "6. Process Payment",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Payment processing started', function() {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}/process",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}", "process"]
								}
							},
							"response": []
						},
						{
							"name": "7. Complete Payment",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Payment completed successfully', function() {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"transactionId\": \"TXN-{{$timestamp}}\"\n}"
								},
								"url": {
									"raw": "{{paymentServiceUrl}}/api/payments/{{paymentId}}/complete",
									"host": ["{{paymentServiceUrl}}"],
									"path": ["api", "payments", "{{paymentId}}", "complete"]
								}
							},
							"response": []
						},
						{
							"name": "8. Verify Order Status",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Order retrieved successfully', function() {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"pm.test('Order status is Submitted', function() {",
											"    var order = pm.response.json();",
											"    pm.expect(order.status).to.equal('Submitted');",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{orderServiceUrl}}/api/orders/{{orderId}}",
									"host": ["{{orderServiceUrl}}"],
									"path": ["api", "orders", "{{orderId}}"]
								}
							},
							"response": []
						}
					],
					"description": "End-to-end workflow: Create order → Add items → Submit → Pay"
				}
			],
			"description": "Pre-configured request sequences for testing common business workflows"
		}
	]
}
